webpackJsonp([1],{119:function(e,t,n){function i(e){n(125)}var a=n(55)(n(165),n(121),i,null,null);e.exports=a.exports},120:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]}},121:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"index",attrs:{"element-loading-text":"拼命加载中..."}},[n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"imFile",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:function(t){e.importFile(this)}}}),e._v(" "),n("a",{attrs:{id:"downlink"}}),e._v(" "),n("el-button",{staticClass:"button",on:{click:function(t){e.uploadFile()}}},[e._v("导入")]),e._v(" "),n("el-button",{staticClass:"button",on:{click:function(t){e.downloadFile(e.excelData)}}},[e._v("导出")]),e._v(" "),n("el-dialog",{attrs:{title:"提示",size:"tiny"},model:{value:e.errorDialog,callback:function(t){e.errorDialog=t},expression:"errorDialog"}},[n("span",[e._v(e._s(e.errorMsg))]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.errorDialog=!1}}},[e._v("确认")])],1)]),e._v(" "),n("el-table",{attrs:{data:e.excelData,"tooltip-effect":"dark"}},[n("el-table-column",{attrs:{label:"名称",prop:"name","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"分量",prop:"size","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"口味",prop:"taste","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"单价(元)",prop:"price","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"剩余(份)",prop:"remain","show-overflow-tooltip":""}})],1)],1)},staticRenderFns:[]}},124:function(e,t){},125:function(e,t){},163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(69),r=n.n(a),o=n(71),l=n(68),s=n.n(l),c=n(70);n.n(c);i.default.config.productionTip=!1,i.default.use(s.a),new i.default({el:"#app",router:o.a,template:"<App/>",components:{App:r.a}})},164:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},165:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(160),a=n.n(i),r=n(65),o=n.n(r),l=n(18),s=n.n(l),c=n(74);t.default={name:"Index",data:function(){return{fullscreenLoading:!1,imFile:"",outFile:"",errorDialog:!1,errorMsg:"",excelData:[{name:"红烧鱼",size:"大",taste:"微辣",price:"40",remain:"100"},{name:"麻辣小龙虾",size:"大",taste:"麻辣",price:"138",remain:"200"},{name:"清蒸小龙虾",size:"大",taste:"清淡",price:"138",remain:"200"},{name:"香辣小龙虾",size:"大",taste:"特辣",price:"138",remain:"200"},{name:"十三香小龙虾",size:"大",taste:"中辣",price:"138",remain:"108"},{name:"蒜蓉小龙虾",size:"大",taste:"中辣",price:"138",remain:"100"},{name:"凉拌牛肉",size:"中",taste:"中辣",price:"48",remain:"60"},{name:"虾仁寿司",size:"大",taste:"清淡",price:"29",remain:"无限"},{name:"海苔寿司",size:"大",taste:"微辣",price:"26",remain:"无限"},{name:"金针菇寿司",size:"大",taste:"清淡",price:"23",remain:"无限"},{name:"泡菜寿司",size:"大",taste:"微辣",price:"24",remain:"无限"},{name:"鳗鱼寿司",size:"大",taste:"清淡",price:"28",remain:"无限"},{name:"肉松寿司",size:"大",taste:"清淡",price:"22",remain:"无限"},{name:"三文鱼寿司",size:"大",taste:"清淡",price:"30",remain:"无限"},{name:"蛋黄寿司",size:"大",taste:"清淡",price:"20",remain:"无限"}]}},mounted:function(){this.imFile=document.getElementById("imFile"),this.outFile=document.getElementById("downlink")},methods:{uploadFile:function(){this.imFile.click()},downloadFile:function(e){var t=[{}];for(var n in e[0])t[0][n]=n;t=t.concat(e),this.downloadExl(t,"菜单")},importFile:function(){this.fullscreenLoading=!0;var e=this.imFile;if(!e.files)return void(this.fullscreenLoading=!1);var t=e.files[0],n=new FileReader,i=this;n.onload=function(e){var t=e.target.result;i.rABS?i.wb=c.read(btoa(this.fixdata(t)),{type:"base64"}):i.wb=c.read(t,{type:"binary"});var n=c.utils.sheet_to_json(i.wb.Sheets[i.wb.SheetNames[0]]);console.log(void 0===n?"undefined":s()(n)),i.dealFile(i.analyzeData(n))},this.rABS?n.readAsArrayBuffer(t):n.readAsBinaryString(t)},downloadExl:function(e,t,n){var i=this,r=[];for(var l in e[0])r.push(l);console.info("keyMap",r,e);var s=[];e.map(function(e,t){return r.map(function(n,a){return o()({},{v:e[n],position:(a>25?i.getCharCol(a):String.fromCharCode(65+a))+(t+1)})})}).reduce(function(e,t){return e.concat(t)}).forEach(function(e){s[e.position]={v:e.v}});var u=a()(s),f={SheetNames:["mySheet"],Sheets:{mySheet:o()({},s,{"!ref":u[0]+":"+u[u.length-1]})}},p=new Blob([this.s2ab(c.write(f,{bookType:void 0===n?"xlsx":n,bookSST:!1,type:"binary"}))],{type:""}),d=URL.createObjectURL(p);this.outFile.download=t+".xlsx",this.outFile.href=d,this.outFile.click(),setTimeout(function(){URL.revokeObjectURL(p)},100)},analyzeData:function(e){return e},dealFile:function(e){console.log(e),this.imFile.value="",this.fullscreenLoading=!1,e.length<=0?(this.errorDialog=!0,this.errorMsg="请导入正确信息"):this.excelData=e},s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),i=0;i!==e.length;++i)n[i]=255&e.charCodeAt(i);return t},getCharCol:function(e){for(var t="",n=0;e>0;)n=e%26+1,t=String.fromCharCode(n+64)+t,e=(e-n)/26;return t},fixdata:function(e){for(var t="",n=0,i=10240;n<e.byteLength/i;++n)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(n*i,n*i+i)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(n*i)))}}}},166:function(e,t){},167:function(e,t){},67:function(e,t){},69:function(e,t,n){function i(e){n(124)}var a=n(55)(n(164),n(120),i,null,null);e.exports=a.exports},70:function(e,t){},71:function(e,t,n){"use strict";var i=n(2),a=n(158),r=n(119),o=n.n(r);i.default.use(a.a),t.a=new a.a({routes:[{path:"/",name:"Index",component:o.a}]})}},[163]);
//# sourceMappingURL=app.36d4005250573a08c97d.js.map